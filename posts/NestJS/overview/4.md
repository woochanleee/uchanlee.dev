---
templateKey: 'blog-post'
title: 'NestJS OVERVIEW(4) - Module'
description: Moduleì— ëŒ€í•´ ì§‘ì¤‘ì ìœ¼ë¡œ ì•Œì•„ë´…ë‹ˆë‹¤.
date: 2021-02-03 07:10:00
category: NestJS
thumbnail: ./images/logo.png
tags:
  - Module
---

![NestJS Logo](./images/logo.png)

[ì›ë¬¸](https://docs.nestjs.com/modules)ì„ ì½ìœ¼ë©° ì •ë¦¬í•©ë‹ˆë‹¤.

### Table of Contents

1. [Modules](#modules)
   - [Feature modules](#feature-modules)
   - [Shared modules](#shared-modules)
   - [Module re-exporting](#module-re-exporting)
   - [Dependency injection](#dependency-injection)
   - [Global modules](#global-modules)
   - [Dynamic modules](#dynamic-modules)

## Modules

Moduleì€ `@Module()` ë°ì½”ë ˆì´í„°ê°€ ë¶™ì€ í´ë˜ìŠ¤ì´ë‹¤. ì´ ë°ì½”ë ˆì´í„°ëŠ” NestJSê°€ ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬ì¡°ë¥¼ ì¡°ì§í•  ìˆ˜ ìˆëŠ” ë©”íƒ€ë°ì´í„°ë¥¼ ì œê³µí•´ì¤€ë‹¤.

![Modules](./images/module.png)
<div style="opacity: 0.5" align="right">
    <sup>Image by: <a>https://docs.nestjs.com/assets/Modules_1.png</a></sup>
</div>

ê° ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ì ì–´ë„ í•˜ë‚˜ì˜ ëª¨ë“ˆ, **root module**ì„ ê°–ëŠ”ë‹¤. ë£¨íŠ¸ ëª¨ë“ˆì€ NestJSê°€ ì• í”Œë¦¬ì¼€ì´ì…˜ ê·¸ë˜í”„(ëª¨ë“ˆ, í”„ë¡œë°”ì´ë” ê´€ê³„ ë° ì˜ì¡´ì„±ì„ ê²°ì •ì§“ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ë‚´ë¶€ ë°ì´í„° êµ¬ì¡°)ë¥¼ ë¹Œë“œí• ë•Œ ì‚¬ìš©í•˜ëŠ” ì‹œì‘ì  ì´ë‹¤. ì´ë¡€ì ìœ¼ë¡œ ì•„ì£¼ ì‘ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ë£¨íŠ¸ ëª¨ë“ˆë§Œ ê°–ì„ ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ NestJSëŠ” ì´ëŸ¬í•œ Moduleì„ ì—¬ëŸ¬ê°œë¡œ êµ¬ì„±í•˜ì—¬ ì»´í¬ë„ŒíŠ¸ë¥¼ ì˜ ì¡°ì§ í•¨ìœ¼ë¡œì¨ ì—­í• ë³„ë¡œ ë‚˜ë‰œ í›Œë¥­í•œ ì•„í‚¤í…ì²˜ë¥¼ êµ¬ì„±í•  ê²ƒì„ ê°•ë ¥í•˜ê²Œ ì¡°ì–¸í•˜ê³¤ í•œë‹¤.

`@Module()`ì€ ê°ì²´ í•˜ë‚˜ë¥¼ ìš”êµ¬í•˜ëŠ”ë°, ê°ì²´ê°€ ê°–ëŠ” ì˜µì…˜ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

	
	
<table>
  <thead>
    <tr>
      <th class="left"></th>
      <th class="left"></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="left">providers</td>
      <td class="left">NestJS ì£¼ì…ìì— ì˜í•´ ì¸ìŠ¤í„´ìŠ¤í™” ë  Providers, ì´ë“¤ì€ ì´ ëª¨ë“ˆ ì•ˆì—ì„œ ê³µìœ ë  ì§€ë„ ëª¨ë¥¸ë‹¤.</td>
    </tr>
      <tr>
      <td class="left">controllers</td>
      <td class="left">ì¸ìŠ¤í„´ìŠ¤í™” ë˜ì–´ì•¼í•  ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ì§‘í•©ì„ ì´ ëª¨ë“ˆì— ì •ì˜í•œë‹¤.</td>
    </tr>
      <tr>
      <td class="left">imports</td>
      <td class="left">import ëœ ëª¨ë“ˆì˜ ë¦¬ìŠ¤íŠ¸ë‹¤. ë§Œì•½ ì´ ëª¨ë“ˆì—ì„œ importí•œ ëª¨ë“ˆì•ˆì— ì •ì˜ëœ providerë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤ë©´ importí•œ ëª¨ë“ˆì€ ê·¸ providerë¥¼ exports ì˜µì…˜ìœ¼ë¡œ ë„£ì–´ì¤˜ì•¼ í•œë‹¤.</td>
    </tr>
      <tr>
      <td class="left">exports</td>
      <td class="left">providersì˜ í•˜ìœ„ ì§‘í•©ìœ¼ë¡œ ì´ ëª¨ë“ˆì— ì„ ì–¸ëœ Providerì˜ ì¼ë¶€ë¥¼ exportí•  ìˆ˜ ìˆë‹¤. ì´ëŠ” ë‹¤ë¥¸ ëª¨ë“ˆì—ì„œ ì´ ëª¨ë“ˆì„ import í• ë•Œ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.</td>
    </tr>
</tbody>
</table>

Moduleì€ ìì—°ìŠ¤ëŸ½ê²Œ Providersë¥¼ ìº¡ìŠí™” í•œë‹¤. ì¦‰, Providers(í˜„ì¬ ëª¨ë‘˜ì˜ ë¶€ë¶„ë„ ì•„ë‹ˆê³  import ëœ ëª¨ë“ˆë¡œë¶€í„° exportëœ ê²ƒë„ ì•„ë‹Œ)ë¥¼ ì£¼ì…í•˜ëŠ”ê²ƒì€ ë¶ˆê°€ëŠ¥í•˜ë‹¤. ê·¸ëŸ¬ë¯€ë¡œ, ëª¨ë“ˆì—ì„œ exportí•œ providerë¥¼ ëª¨ë“ˆì˜ public interface ë˜ëŠ” apië¡œ ê°„ì£¼í•  ìˆ˜ ìˆë‹¤.

> ì´ ë¶€ë¶„ì€ í•´ì„ì´ ì˜ ì•ˆëœë‹¤...ğŸ˜­

### Feature modules

ì˜ˆì œì—ì„œ `CatsController`ê³¼ `CatsService`ëŠ” ê°™ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ ë„ë©”ì¸ì— ì†í•œë‹¤. ë”°ë¼ì„œ feature moduleë¡œ ë¬¶ê¸°ì— íƒ€ë‹¹í•˜ë‹¤. feature moduleì€ ê°„ë‹¨í•˜ê²Œ íŠ¹ì • ê¸°ëŠ¥ê³¼ ì½”ë“œë¥¼ ê´€ë ¨ìˆê²Œ ì¡°ì§í•  ìˆ˜ ìˆë‹¤. ë˜, ì½”ë“œë¥¼ ëª…ë°±í•œ ê²½ê³„ë¡œ ìœ ì§€í•  ìˆ˜ ìˆë‹¤. ì´ëŠ” `SOLID`ì›ì¹™ê³¼ í•¨ê»˜ ê°œë°œì„ í• ë•Œ ë³µì¡ì„±ì„ ì¤„ì—¬ì£¼ê³  ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í¬ê¸°ì™€ íŒ€ì˜ ì„±ì¥ì„ ë„ì™€ì¤€ë‹¤.

`CatsModule`ì„ ë§Œë“¤ì–´ ë³´ì.

```shell
$ nest g module cats
```

```ts
// src/cats/cats.module.ts
import { Module } from '@nestjs/common';
import { CatsController } from './cats.controller';
import { CatsService } from './cats.service';

@Module({
  controllers: [CatsController],
  providers: [CatsService],
})
export class CatsModule {}
```

ì´ ëª¨ë“ˆê³¼ ê´€ë ¨ëœ íŒŒì¼ì„ ëª¨ë‘ `cats` í´ë”ì— ëª¨ì„ ìˆ˜ ìˆë‹¤. ì¶”ê°€ë¡œ í•´ì•¼í•  ì‘ì—…ì€ cats ëª¨ë“ˆì„ root module(`src/app.module.ts` file)ì— import í•´ì¤˜ì•¼ í•œë‹¤.

```ts
// app.module.ts
import { Module } from '@nestjs/common';
import { CatsModule } from './cats/cats.module';

@Module({
  imports: [CatsModule],
})
export class AppModule {}
```

ì´ì œ í”„ë¡œì íŠ¸ êµ¬ì¡°ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.

```
src
â”œâ”€ cats
â”‚  â”œâ”€ dto
â”‚  â”‚  â””â”€ create-cat.dto.ts
â”‚  â”œâ”€ interfaces
â”‚  â”‚  â””â”€ cat.interface.ts
â”‚  â”œâ”€ cats.service.ts
â”‚  â”œâ”€ cats.controller.ts
â”‚  â””â”€ cats.module.ts
â”œâ”€ app.module.ts
â””â”€ main.ts
```

### Shared modules

NestJSì—ì„œ Moduleì€ ë””í´íŠ¸ë¡œ ì‹±ê¸€í†¤ì´ë‹¤. ë”°ë¼ì„œ, ì–´ëŠ Provider ì¸ìŠ¤í„´ìŠ¤ë“  ì—¬ëŸ¬ ëª¨ë“ˆ ì‚¬ì´ì—ì„œ ì‰½ê²Œ ê³µìœ í•  ìˆ˜ ìˆë‹¤.

![Shared modules](./images/shared-module.png)
<div style="opacity: 0.5" align="right">
    <sup>Image by: <a>https://docs.nestjs.com/assets/Shared_Module_1.png</a></sup>
</div>

ëª¨ë“  ëª¨ë“ˆì€ ìë™ì ìœ¼ë¡œ **shared module**ì´ë‹¤. ìƒì„±ë˜ìë§ˆì ëª¨ë“  ëª¨ë“ˆì—ì„œ ì¬ì‚¬ìš© í•  ìˆ˜ ìˆë‹¤. ë§Œì•½ `CatsService`ë¥¼ ë‹¤ë¥¸ ëª¨ë“ˆì—ì„œ ì‚¬ìš©í•´ì•¼ í•œë‹¤ê³  í•˜ì. ê·¸ë ‡ë‹¤ë©´ ìš°ë¦¬ëŠ” `CatsService` Provierë¥¼ moduleì˜ `exports` ë°°ì—´ì— ì¶”ê°€í•´ì¤˜ì•¼ í•œë‹¤. ì•„ë˜ì™€ ê°™ë‹¤.

```ts
// cats.module.ts
import { Module } from '@nestjs/common';
import { CatsController } from './cats.controller';
import { CatsService } from './cats.service';

@Module({
  controllers: [CatsController],
  providers: [CatsService],
  exports: [CatsService]
})
export class CatsModule {}
```

ì´ì œ ì–´ëŠ ëª¨ë“ˆì—ì„œë“ ì§€ `CatsModule`ì„ import í•˜ê¸°ë§Œ í•˜ë©´ `CatsService`ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

### Module re-exporting

ìœ„ì—ì„œ ë³¸ ê²ƒ ì²˜ëŸ¼, ëª¨ë“ˆë“¤ì€ ë‚´ë¶€ Providersë¥¼ export í•  ìˆ˜ ìˆë‹¤. ê²Œë‹¤ê°€, ëª¨ë“ˆì€ importí•œ ê²ƒì„ re-export í•  ìˆ˜ ìˆë‹¤. ì•„ë˜ ì˜ˆì œì²˜ëŸ¼, `CommonModule`ì€ `CoreModule`ì—ì„œ import ë¿ë§Œ ì•„ë‹ˆë¼ export ê¹Œì§€ í•œë‹¤. ì´ë ‡ê²Œ í•¨ìœ¼ë¡œì¨ ë‹¤ë¥¸ ëª¨ë“ˆì—ì„œëŠ” `CoreModule`ì„ importí•˜ë©´ `CommonModule` ë˜í•œ ì´ìš© ê°€ëŠ¥í•˜ë‹¤.

### Dependency injection

Module í´ë˜ìŠ¤ëŠ” providerë¥¼ ì£¼ì…í•  ìˆ˜ë„ ìˆë‹¤.

```ts
// cats.module.ts
import { Module } from '@nestjs/common';
import { CatsController } from './cats.controller';
import { CatsService } from './cats.service';

@Module({
  controllers: [CatsController],
  providers: [CatsService], // ìƒì„±ìë¡œ ì£¼ì…í–ˆë‹¤ê³  ì—¬ê¸°ì— ì „ë‹¬ ì•ˆí•´ë„ ë˜ëŠ”ê±´ ì•„ë‹ˆë‹¤.
})
export class CatsModule {
  constructor(private catsService: CatsService) {}
}
```

ê·¸ëŸ¬ë‚˜ module í´ë˜ìŠ¤ëŠ” ê·¸ ìì²´ë¡œëŠ” inject ë  ìˆ˜ ì—†ë‹¤. [ìˆœí™˜ ì°¸ì¡°](https://docs.nestjs.com/fundamentals/circular-dependency) ë¬¸ì œ ë–„ë¬¸ì´ë‹¤.

### Global modules

ë§Œì•½ ê°™ì€ ëª¨ë“ˆì„ ëª¨ë“  ê³³ì—ì„œ import í•´ì•¼í•œë‹¤ë©´ êµ‰ì¥íˆ tedious(ì§€ë£¨í•œ)í•  ê²ƒì´ë‹¤. ê·¸ë˜ì„œ NestJSì—ì„œëŠ” Global Scopeì— ë“±ë¡í•  ìˆ˜ ìˆë‹¤.

NestJSëŠ” ëª¨ë“ˆ ìŠ¤ì½”í”„ ì•ˆì—ì„œ í”„ë¡œë°”ì´ë”ë¥¼ ìº¡ìŠí™” í•œë‹¤. ê·¸ë˜ì„œ ìº¡ìŠí™”ëœ ëª¨ë“ˆì„ ì²˜ìŒ importí•˜ê¸° ì „ê¹Œì§„ ê·¸ ëª¨ë“ˆì˜ í”„ë¡œë°”ì´ë”ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.

ì–´ë””ì„œë“ ì§€ ì´ìš©ê°€ëŠ¥í•œ providerì˜ ì§‘í•©ì„ ì›í•œë‹¤ë©´ `@Global()` ë°ì½”ë ˆì´í„°ë¥¼ ë¶™ì—¬ **global**ë¡œ ë§Œë“¤ë©´ ëœë‹¤.

```ts
import { Module, Global } from '@nestjs/common';
import { CatsController } from './cats.controller';
import { CatsService } from './cats.service';

@Global()
@Module({
  controllers: [CatsController],
  providers: [CatsService],
  exports: [CatsService],
})
export class CatsModule {}
```

`@Global()` ë°ì½”ë ˆì´í„°ëŠ” ëª¨ë“ˆì„ global-scopedë¡œ ë§Œë“¤ì–´ ì¤€ë‹¤. Global moduleì€ í•˜ë‚˜ë§Œ ë“±ë¡ë  ìˆ˜ ìˆë‹¤(app module, cats moduleì— ë‘˜ë‹¤ ë°ì½”ë ˆì´í„°ë¥¼ ë¶™ì—¬ë´¤ëŠ”ë° ì—ëŸ¬ê°€ ì•ˆë‚œë‹¤. í•œë²ˆë§Œì´ ì•„ë‹Œê°€?). ì¼ë°˜ì ìœ¼ë¡œ root ë˜ëŠ” core ëª¨ë“ˆì— ë“±ë¡í•œë‹¤. ìœ„ ì˜ˆì‹œì—ì„œëŠ” `CatsService` Providerê°€ ìœ ë¹„ì¿¼í„°ìŠ¤ í•˜ê³  ëª¨ë“ˆë“¤ì´ injectë˜ê¸°ë¥¼ ë°”ë˜ì„œ `CatsModule`ì„ importí•  í•„ìš”ê°€ ì—†ê²Œ ë§Œë“¤ì—ˆë‹¤.

ê³µì‹ ë¬¸ì„œì— ë”°ë¥´ë©´, ëª¨ë“  ê²ƒì„ ê¸€ë¡œë²Œë¡œ ë§Œë“œëŠ” ê²ƒì€ ì¢‹ì€ ê²°ì •ì´ ì•„ë‹ˆë¼ê³  í•œë‹¤. Global moduleì€ ë§ì€ boilerplateë¥¼ ì¤„ì´ê¸° ìœ„í•´ ì´ìš© ê°€ëŠ¥í•˜ë‹¤. ëª¨ë“ˆì˜ apië¥¼ consumers(??? ë‹¤ë¥¸ ëª¨ë“ˆì„ ë§í•˜ëŠ” ê±´ê°€?)ê°€ ì´ìš©ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ê¸° ìœ„í•´ `imports`ë£° ì·¨í•˜ëŠ” ë°©ë²•ì´ ì¼ë°˜ì ì´ë‹¤. 

### Dynamic modules

NestJS ëª¨ë“ˆ ì‹œìŠ¤í…œì€ **Dynamic modules**ë¼ê³  ë¶ˆë¦¬ëŠ” ê°•ë ¥í•œ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤. ì´ ê¸°ëŠ¥ì€ ì‰½ê²Œ ì»¤ìŠ¤í…€ ê°€ëŠ¥í•œ ëª¨ë“ˆì„ ë§Œë“¤ ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ”ë°, ì´ ëª¨ë“ˆì€ ë™ì ìœ¼ë¡œ ë“±ë¡ ë° providersë¥¼ ì„¤ì • ê°€ëŠ¥ì¼€ í•œë‹¤. Dynamic modulesì€ [ì—¬ê¸°ì„œ](https://docs.nestjs.com/fundamentals/dynamic-modules) ë” ì•Œì•„ë³¼ ìˆ˜ ìˆë‹¤. ì´ë²ˆ ê¸€ì—ì„  ê°„ë‹¨í•œ ì˜ˆì‹œë¥¼ ë³´ì—¬ì¤€ë‹¤.

```ts
import { Module, DynamicModule } from '@nestjs/common';
import { createDatabaseProviders } from './database.providers';
import { Connection } from './connection.provider';

@Module({
  providers: [Connection],
})
export class DatabaseModule {
  static forRoot(entities = [], options?): DynamicModule {
    const providers = createDatabaseProviders(options, entities);
    return {
      module: DatabaseModule,
      providers: providers,
      exports: providers,
    };
  }
}
```

ì´ ëª¨ë“ˆì€ `Connection` Providerë¥¼ ë””í´íŠ¸ë¡œ ì •ì˜í•œë‹¤. ê·¸ëŸ¬ë‚˜, ì¶”ê°€ì ìœ¼ë¡œ, `forRoot()` ë©”ì„œë“œì— ë„˜ì–´ì˜¨ `entities`ì™€ `options`ì— ì˜ì¡´í•´ ìƒˆë¡œìš´ Providerë¥¼ ë§Œë“ ë‹¤(ì˜ˆë¥¼ ë“¤ì–´ repositoriesë¼ ì¹˜ì.). dynamic moduleì— ë¦¬í„´ë˜ëŠ” í”„ë¡œí¼í‹°ë“¤ì€ `override`ë˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ `@Module()`ì•ˆ ê¸°ë³¸ ëª¨ë“ˆì— ì •ì˜ëœ ë©”íƒ€ë°ì´í„°ë¥¼ í™•ì¥í•œë‹¤. ì´ë ‡ê²Œ ì •ì ìœ¼ë¡œ ì„ ì–¸ëœ `Connection` Providerì™€ ë™ì ìœ¼ë¡œ ìƒì„±ëœ `repository` Providerê°€ ì´ ëª¨ë“ˆì—ì„œ export ëœë‹¤.

ë§Œì•½ dynamic moduleì„ ê¸€ë¡œë²Œ ìŠ¤ì½”í”„ë¡œ ë“±ë¡í•˜ê³  ì‹¶ë‹¤ë©´ ë¦¬í„´í•  ë•Œ `global` í”„ë¡œí¼í‹°ë¥¼ `true`ë¡œ ì„¤ì •í•˜ë©´ ëœë‹¤.

```ts
{
  global: true,
  module: DatabaseModule,
  providers: providers,
  exports: providers,
}
```

`DatabaseModule` ì€ ì•„ë˜ ë°©ì‹ìœ¼ë¡œ import ë˜ê³  configure ë  ìˆ˜ ìˆë‹¤.

```ts
import { Module } from '@nestjs/common';
import { DatabaseModule } from './database/database.module';
import { User } from './users/entities/user.entity';

@Module({
  imports: [DatabaseModule.forRoot([User])],
})
export class AppModule {}
```

ë§Œì•½ ë™ì  ëª¨ë“ˆì„ re-exportí•˜ê³  ì‹¶ë‹¤ë©´ `forRoot()` í˜¸ì¶œ ë¶€ë¶„ë§Œ omit(ë¹ íŠ¸ë¦¬ê³ )í•˜ê³  exports ë°°ì—´ì— ë„£ì–´ì£¼ë©´ ëœë‹¤.

```ts
import { Module } from '@nestjs/common';
import { DatabaseModule } from './database/database.module';
import { User } from './users/entities/user.entity';

@Module({
  imports: [DatabaseModule.forRoot([User])],
  exports: [DatabaseModule],
})
export class AppModule {}
```

[dynamic modules](https://docs.nestjs.com/fundamentals/dynamic-modules)ì—ì„œ ë” ìì„¸íˆ ë‹¤ë£¨ê³  [ì˜ˆì œ](https://github.com/nestjs/nest/tree/master/sample/25-dynamic-modules)ë¥¼ í¬í•¨í•œë‹¤.

|       |                                                               |
| :---: | :-----------------------------------------------------------: |
| Next  | [NestJS OVERVIEW(5) - Middleware](https://uchanlee.dev/NestJS/overview/5) |
| Intro | [NestJS OVERVIEW(0) - Intro](https://uchanlee.dev/NestJS/overview/0) |
